{"version":3,"sources":["../../../src/states/common.ts","../../../src/states/linkState.ts","../../../src/components/LinkDefault.tsx","../../../src/linkConstructors/common.ts","../../../src/states/linksSettingsState.ts","../../../src/linkConstructors/simple.ts","../../../src/components/NodeDefault.tsx","../../../src/states/nodesSettingsState.ts","../../../src/states/nodeState.ts","../../../src/hooks/nodeHooks.tsx","../../../src/hooks/linkHooks.ts","../../../src/hooks/useNotifyRef.ts","../../../src/components/LinkWrapper.tsx","../../../src/components/LinksLayer.tsx","../../src/utils.ts","../../../src/hooks/useDragAndZoom.ts","../../../src/states/diagramState.ts","../../../src/components/NodeWrapper.tsx","../../../src/components/NodesLayer.tsx","../../../src/states/initializers.ts","../../../src/components/DiagramInner.tsx","../../../src/components/Diagram.tsx","ControlPanel.tsx","App.tsx","../../../src/hooks/useDiagram.tsx","index.tsx"],"names":["current","key","getScale","snap","set","useStyles","makeStyles","form","display","flexDirection","gap","visibilityBtn","borderRadius","minWidth","padding","backgroundColor","header","marginBottom","alignItems","ControlPanel","props","classes","useState","row","setRow","col","setCol","visible","setVisible","Box","clone","Card","className","Button","variant","aria-label","onClick","Tune","Typography","noValidate","autoComplete","onSubmit","e","reinitState","colNum","rowNum","nodes","links","getNodeId","i","j","push","id","position","x","y","source","nodeId","target","generateLargeDiagram","preventDefault","stopPropagation","TextField","value","type","label","onChange","parseInt","diagram","height","width","backgroundImage","controlPanel","top","left","App","useDiagram","initState","Diagram","apiRef","setState","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e701c7ce.chunk.js","sourcesContent":["export var libraryPrefix = 'reactEasyDiagram';\r\n//# sourceMappingURL=common.js.map","import { atom, atomFamily } from 'recoil';\r\nimport { libraryPrefix } from './common';\r\nexport var linksIdsState = atom({\r\n    key: libraryPrefix + \"_LinksIds\",\r\n    default: [],\r\n});\r\nexport var linkWithIdState = atomFamily({\r\n    key: libraryPrefix + \"_Link\",\r\n    default: function (id) { return ({ id: id, type: defaultLinkType }); },\r\n});\r\nexport var defaultLinkType = 'simple';\r\n//# sourceMappingURL=linkState.js.map","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport React, { forwardRef } from 'react';\r\nexport var LinkDefault = forwardRef(function (props, ref) {\r\n    var settings = __assign({ color: 'LightBlue', strokeWidth: 3 }, (props.settings ? props.settings : {}));\r\n    return (React.createElement(\"path\", { ref: ref, d: props.path, stroke: settings.color, strokeWidth: settings.strokeWidth, fill: 'none' }));\r\n});\r\nexport var createLinkDefault = function (props) { return LinkDefault(props); };\r\n// <g>\r\n//       {/* Main line */}\r\n//       <path d={points} stroke={linkColor} strokeWidth=\"3\" fill=\"none\" />\r\n//       {/* Thick line to make selection easier */}\r\n//       <path\r\n//         d={points}\r\n//         stroke={linkColor}\r\n//         strokeWidth=\"20\"\r\n//         fill=\"none\"\r\n//         strokeLinecap=\"round\"\r\n//         strokeOpacity={isHovered || isSelected ? 0.1 : 0}\r\n//         onMouseEnter={() => onLinkMouseEnter({ config, linkId: link.id })}\r\n//         onMouseLeave={() => onLinkMouseLeave({ config, linkId: link.id })}\r\n//         onClick={(e) => {\r\n//           onLinkClick({ config, linkId: link.id })\r\n//           e.stopPropagation()\r\n//         }}\r\n//       />\r\n//     </g>\r\n//# sourceMappingURL=LinkDefault.js.map","export function getEndpointPoint(endpoint) {\r\n    if ('node' in endpoint) {\r\n        return getEndpointPointForNode(endpoint);\r\n    }\r\n    else {\r\n        return endpoint.position;\r\n    }\r\n}\r\nexport function getEndpointPointForNode(endpoint) {\r\n    var _a, _b;\r\n    var htmlElem = (_b = (_a = endpoint.node) === null || _a === void 0 ? void 0 : _a.ref) === null || _b === void 0 ? void 0 : _b.current;\r\n    if (htmlElem) {\r\n        return {\r\n            x: endpoint.node.position.x +\r\n                (htmlElem.clientWidth ? htmlElem.clientWidth / 2 : 0),\r\n            y: endpoint.node.position.y +\r\n                (htmlElem.clientHeight ? htmlElem.clientHeight / 2 : 0),\r\n        };\r\n    }\r\n    else {\r\n        return endpoint.node.position;\r\n    }\r\n}\r\n//# sourceMappingURL=common.js.map","import { atom } from 'recoil';\r\nimport { LinkDefault } from '../components/LinkDefault';\r\nimport { simpleLinkPathConstructor } from '../linkConstructors/simple';\r\nimport { libraryPrefix } from './common';\r\nimport { defaultLinkType } from './linkState';\r\nexport var linksSettingsState = atom({\r\n    key: libraryPrefix + \"_LinksSettings\",\r\n    default: {\r\n        defaultLinkType: defaultLinkType,\r\n        linkComponents: {\r\n            default: LinkDefault,\r\n        },\r\n        pathConstructor: simpleLinkPathConstructor,\r\n    },\r\n});\r\n//# sourceMappingURL=linksSettingsState.js.map","import { getEndpointPoint } from './common';\r\nexport function simpleLinkPathConstructor(state) {\r\n    var fromPoint = getEndpointPoint(state.source);\r\n    var toPoint = getEndpointPoint(state.target);\r\n    var path = \"M \" + fromPoint.x + \" \" + fromPoint.y + \", \" + toPoint.x + \" \" + toPoint.y;\r\n    return path;\r\n}\r\n//# sourceMappingURL=simple.js.map","import React, { forwardRef } from 'react';\r\nexport var NodeDefault = forwardRef(function (props, draggableRef) {\r\n    var _a;\r\n    return (React.createElement(\"div\", { ref: draggableRef, className: 'react_fast_diagram_Node_Default', style: (_a = props.settings) === null || _a === void 0 ? void 0 : _a.style },\r\n        React.createElement(\"span\", null, props.node.id)));\r\n});\r\nexport function createNodeDefault(settings) {\r\n    return {\r\n        component: NodeDefault,\r\n        settings: settings,\r\n    };\r\n}\r\n//# sourceMappingURL=NodeDefault.js.map","import { atom, selectorFamily } from 'recoil';\r\nimport { defaultNodeType } from '..';\r\nimport { NodeDefault } from '../components/NodeDefault';\r\nimport { libraryPrefix } from './common';\r\nexport var nodesSettingsState = atom({\r\n    key: libraryPrefix + \"_NodesSettings\",\r\n    default: {\r\n        defaultNodeType: defaultNodeType,\r\n        nodeComponents: {\r\n            default: NodeDefault,\r\n        },\r\n    },\r\n});\r\nexport var nodeComponentDefinitionState = selectorFamily({\r\n    key: libraryPrefix + \"_NodeComponentDefinition\",\r\n    get: function (componentType) { return function (_a) {\r\n        var get = _a.get;\r\n        var settings = get(nodesSettingsState);\r\n        componentType = componentType !== null && componentType !== void 0 ? componentType : defaultNodeType;\r\n        var componentDefinition = componentType in settings.nodeComponents\r\n            ? settings.nodeComponents[componentType]\r\n            : settings.nodeComponents[defaultNodeType];\r\n        return 'component' in componentDefinition\r\n            ? componentDefinition\r\n            : {\r\n                component: componentDefinition,\r\n            };\r\n    }; },\r\n});\r\n//# sourceMappingURL=nodesSettingsState.js.map","import { atom, atomFamily } from 'recoil';\r\nimport { libraryPrefix } from './common';\r\nexport var nodesIdsState = atom({\r\n    key: libraryPrefix + \"_NodesIds\",\r\n    default: [],\r\n});\r\nexport var defaultNodeType = 'default';\r\nexport var nodeWithIdState = atomFamily({\r\n    key: libraryPrefix + \"_Node\",\r\n    default: function (id) { return ({\r\n        id: id,\r\n        position: { x: 0, y: 0 },\r\n        type: defaultNodeType,\r\n    }); },\r\n});\r\n//# sourceMappingURL=nodeState.js.map","import { useRecoilState } from 'recoil';\r\nimport { nodesSettingsState, } from '../states/nodesSettingsState';\r\nimport { nodeWithIdState } from '../states/nodeState';\r\nexport var useNodeState = function (id) { return useRecoilState(nodeWithIdState(id)); };\r\nexport var useNodesSettings = function () { return useRecoilState(nodesSettingsState); };\r\n// export const useNodeComponent = (\r\n//   type?: string\r\n// ): ((propsWithRef: INodePropsWithRef) => JSX.Element) => {\r\n//   const nodeComponentDefinition = useRecoilValue(\r\n//     nodeComponentDefinitionState(type ?? defaultNodeType)\r\n//   );\r\n//   if ('component' in nodeComponentDefinition) {\r\n//     const NodeComponent = nodeComponentDefinition.component;\r\n//     return {nodeComponentDefinition.component\r\n//   } else {\r\n//     const NodeComponent = nodeComponentDefinition;\r\n//     return (props) => <NodeComponent {...props} />;\r\n//   }\r\n// };\r\n//# sourceMappingURL=nodeHooks.js.map","import { useRecoilState } from 'recoil';\r\nimport { linksSettingsState } from '../states/linksSettingsState';\r\nimport { linkWithIdState, } from '../states/linkState';\r\nimport { useNodeState } from './nodeHooks';\r\nexport var useLinksSettings = function () { return useRecoilState(linksSettingsState); };\r\nexport var useLinkState = function (id) { return useRecoilState(linkWithIdState(id)); };\r\n// Use recoil selector instead\r\nexport var useLinkStateExtended = function (id) {\r\n    var _a = useLinkState(id), link = _a[0], setLink = _a[1];\r\n    var sourceNode = useNodeState(getNodeIdForLinkEndpoint(link.source))[0];\r\n    var targetNode = useNodeState(getNodeIdForLinkEndpoint(link.target))[0];\r\n    return [\r\n        {\r\n            link: link,\r\n            source: {\r\n                node: sourceNode,\r\n            },\r\n            target: {\r\n                node: targetNode,\r\n            },\r\n        },\r\n        setLink,\r\n    ];\r\n};\r\nvar getNodeIdForLinkEndpoint = function (target) {\r\n    if (!target) {\r\n        return '';\r\n    }\r\n    if ('nodeId' in target) {\r\n        return target.nodeId;\r\n    }\r\n    else {\r\n        return '';\r\n    }\r\n};\r\n//# sourceMappingURL=linkHooks.js.map","import { useState } from \"react\";\r\nexport var useNotifyRef = function (init) {\r\n    var _a = useState(0), _ = _a[0], forceUpdate = _a[1];\r\n    var ref = useState(function () { return ({\r\n        value: init,\r\n        facade: {\r\n            get current() {\r\n                return ref.value;\r\n            },\r\n            set current(value) {\r\n                var last = ref.value;\r\n                if (last !== value) {\r\n                    ref.value = value;\r\n                    forceUpdate(function (i) { return i + 1; });\r\n                }\r\n            },\r\n        },\r\n    }); })[0];\r\n    return ref.facade;\r\n};\r\n//# sourceMappingURL=useNotifyRef.js.map","import React from 'react';\r\nimport { useLinksSettings, useLinkStateExtended, } from '../hooks/linkHooks';\r\nimport { useNotifyRef } from '../hooks/useNotifyRef';\r\nexport var LinkWrapper = function (_a) {\r\n    var _b;\r\n    var id = _a.id;\r\n    var linkStateExtended = useLinkStateExtended(id)[0];\r\n    var linksSettings = useLinksSettings()[0];\r\n    var linkRef = useNotifyRef(null);\r\n    var linkType = linkStateExtended.link.type;\r\n    var path = linksSettings.pathConstructor(linkStateExtended);\r\n    var linkComponent = (_b = linksSettings.linkComponents[linkType]) !== null && _b !== void 0 ? _b : linksSettings.linkComponents.default;\r\n    var Link = 'component' in linkComponent ? linkComponent.component : linkComponent;\r\n    return (React.createElement(\"g\", null,\r\n        React.createElement(Link, { ref: linkRef, path: path })));\r\n};\r\nexport var LinkWrapperMemo = React.memo(LinkWrapper);\r\n//# sourceMappingURL=LinkWrapper.js.map","import React from 'react';\r\nimport { useRecoilState } from 'recoil';\r\nimport { linksIdsState } from '../states/linkState';\r\nimport { LinkWrapperMemo } from './LinkWrapper';\r\nvar LinksLayer = function () {\r\n    var links = useRecoilState(linksIdsState)[0];\r\n    return (React.createElement(\"svg\", null, links.map(function (id) { return (React.createElement(LinkWrapperMemo, { key: id, id: id })); })));\r\n};\r\nexport var LinksLayerMemorized = React.memo(LinksLayer);\r\n//# sourceMappingURL=LinksLayer.js.map","export var generateTransform = function (translate, scale) {\r\n    var translatePart = \"translate(\" + translate.x + \"px, \" + translate.y + \"px)\";\r\n    if (scale) {\r\n        var scalePart = \"scale(\" + scale + \")\";\r\n        return translatePart + ' ' + scalePart;\r\n    }\r\n    else {\r\n        return translatePart;\r\n    }\r\n};\r\n// See: https://stackoverflow.com/a/30039971/9142642\r\nexport var computeTransformationOnScale = function (target, midpoint, translate, scale, factor) {\r\n    // The upper left corner of the target stays in the same place while the picture is enlarged\r\n    var rect = target.getBoundingClientRect();\r\n    // Get mouse position related to target\r\n    var mouseXPos = midpoint.x - rect.left;\r\n    var mouseYPos = midpoint.y - rect.top;\r\n    // Now consider the point under the mouse cursor. Every pixel above and to the\r\n    // left of the cursor has become *factor* larger. This displaces the point under the\r\n    // cursor by *factor* downward and to the right. Meanwhile, the cursor is in the same position.\r\n    // Note that the target might have been moved in the canvas before the zooming operation, so the\r\n    // cursor's horizontal position in the target is mouseXPos - transformation.translation.x before zooming,\r\n    // and likewise for the vertical position.\r\n    var dx = (mouseXPos - translate.x) * (factor - 1);\r\n    var dy = (mouseYPos - translate.y) * (factor - 1);\r\n    return {\r\n        scale: scale * factor,\r\n        translate: {\r\n            // Compensate for the displacement by moving the point back under the cursor\r\n            x: translate.x - dx,\r\n            y: translate.y - dy,\r\n        },\r\n    };\r\n};\r\nexport var roundPoint = function (point) { return ({\r\n    x: Math.round(point.x),\r\n    y: Math.round(point.y),\r\n}); };\r\nexport var addPoints = function (a, b) { return ({\r\n    x: a.x + b.x,\r\n    y: a.y + b.y\r\n}); };\r\nexport var subtractPoints = function (a, b) { return ({\r\n    x: a.x - b.x,\r\n    y: a.y - b.y\r\n}); };\r\nexport var multiplyPoint = function (a, m) { return ({\r\n    x: a.x * m,\r\n    y: a.y * m\r\n}); };\r\n//# sourceMappingURL=utils.js.map","import { useEffect, useRef } from 'react';\r\nimport { useGesture } from 'react-use-gesture';\r\nimport { addPoints, computeTransformationOnScale, generateTransform, } from '../utils';\r\nimport { useNotifyRef } from './useNotifyRef';\r\nexport var useDragAndZoom = function (props) {\r\n    var _a, _b, _c, _d;\r\n    // useState instead of reference cause the situation, when multiple gesture callback invocations go before state actually updates,\r\n    // so those invocations will rely on old state data.\r\n    var state = useNotifyRef({\r\n        scale: (_a = props.initScale) !== null && _a !== void 0 ? _a : 1,\r\n        translate: (_b = props.initTranslate) !== null && _b !== void 0 ? _b : { x: 0, y: 0 },\r\n    });\r\n    var pinchState = useRef({\r\n        distance: 0,\r\n        origin: [0, 0],\r\n    });\r\n    // Should trigger rendering on change, otherwise useEffect will not be invoked\r\n    var active = useNotifyRef(false);\r\n    useGesture({\r\n        onDrag: function (_a) {\r\n            var _b;\r\n            var delta = _a.delta, pinching = _a.pinching;\r\n            if (!active.current || pinching) {\r\n                return;\r\n            }\r\n            var parentScale = (_b = props.parentScale) !== null && _b !== void 0 ? _b : 1;\r\n            state.current = {\r\n                scale: state.current.scale,\r\n                translate: {\r\n                    x: state.current.translate.x + delta[0] / parentScale,\r\n                    y: state.current.translate.y + delta[1] / parentScale,\r\n                },\r\n            };\r\n        },\r\n        onDragStart: function (_a) {\r\n            var event = _a.event;\r\n            var gestureStartInAppropriateElem = !props.listenOnlyClass ||\r\n                eventTargetContainsClass(event.target, props.listenOnlyClass);\r\n            if (gestureStartInAppropriateElem) {\r\n                active.current = true;\r\n            }\r\n        },\r\n        onDragEnd: function () { return (active.current = false); },\r\n        onPinch: function (_a) {\r\n            var distance = _a.da[0], origin = _a.origin;\r\n            if (!active.current) {\r\n                return;\r\n            }\r\n            var originDiff = {\r\n                x: origin[0] - pinchState.current.origin[0],\r\n                y: origin[1] - pinchState.current.origin[1],\r\n            };\r\n            var diff = distance - pinchState.current.distance;\r\n            if (Math.abs(diff) > 1 && props.elemToAttachTo.current) {\r\n                var elWidth = props.elemToAttachTo.current.clientWidth * state.current.scale;\r\n                var targetElWidth = elWidth + diff;\r\n                var factor = targetElWidth / elWidth;\r\n                var scaleTransformation = computeTransformationOnScale(props.elemToAttachTo.current, { x: origin[0], y: origin[1] }, state.current.translate, state.current.scale, factor);\r\n                scaleTransformation.translate = addPoints(scaleTransformation.translate, originDiff);\r\n                pinchState.current = {\r\n                    distance: distance,\r\n                    origin: origin,\r\n                };\r\n                state.current = scaleTransformation;\r\n            }\r\n            else {\r\n                pinchState.current = {\r\n                    distance: pinchState.current.distance,\r\n                    origin: origin,\r\n                };\r\n                state.current = {\r\n                    scale: state.current.scale,\r\n                    translate: addPoints(state.current.translate, originDiff),\r\n                };\r\n            }\r\n        },\r\n        onPinchStart: function (_a) {\r\n            var distance = _a.da[0], origin = _a.origin;\r\n            pinchState.current = {\r\n                distance: distance,\r\n                origin: origin,\r\n            };\r\n            active.current = true;\r\n        },\r\n        onPinchEnd: function () { return (active.current = false); },\r\n        onWheel: function (_a) {\r\n            var _b = _a.direction, _ = _b[0], yDirection = _b[1], _c = _a.event, clientX = _c.clientX, clientY = _c.clientY;\r\n            if (props.elemToAttachTo.current) {\r\n                var factor = 0.9;\r\n                if (yDirection < 0) {\r\n                    factor = 1 / factor;\r\n                }\r\n                var newTransformation = computeTransformationOnScale(props.elemToAttachTo.current, { x: clientX, y: clientY }, state.current.translate, state.current.scale, factor);\r\n                state.current = newTransformation;\r\n            }\r\n        },\r\n    }, {\r\n        domTarget: props.elemToAttachTo,\r\n        eventOptions: { passive: false },\r\n        pinch: { enabled: !!props.enableZoom },\r\n        wheel: { enabled: !!props.enableZoom },\r\n    });\r\n    useUserSelectSwitcher(active.current, (_d = (_c = props.elemToAttachTo.current) === null || _c === void 0 ? void 0 : _c.ownerDocument) === null || _d === void 0 ? void 0 : _d.body);\r\n    return {\r\n        transform: generateTransform(state.current.translate, props.enableZoom ? state.current.scale : undefined),\r\n        scale: state.current.scale,\r\n        translate: state.current.translate,\r\n    };\r\n};\r\nfunction eventTargetContainsClass(eventTarget, className) {\r\n    if (eventTarget && 'classList' in eventTarget) {\r\n        return eventTarget.classList.contains(className);\r\n    }\r\n    else\r\n        return false;\r\n}\r\nfunction useUserSelectSwitcher(active, elementToSwitchUserSelectOn) {\r\n    useEffect(function () {\r\n        if (!active || !elementToSwitchUserSelectOn) {\r\n            return;\r\n        }\r\n        elementToSwitchUserSelectOn.classList.add('react_fast_diagram_disabled_user_select');\r\n        return function () {\r\n            elementToSwitchUserSelectOn.classList.remove('react_fast_diagram_disabled_user_select');\r\n        };\r\n    }, [active, elementToSwitchUserSelectOn]);\r\n}\r\n//# sourceMappingURL=useDragAndZoom.js.map","import { atom, DefaultValue, selector } from 'recoil';\r\nimport { libraryPrefix } from './common';\r\nexport var diagramTranslateState = atom({\r\n    key: libraryPrefix + \"_DiagramTranslate\",\r\n    default: {\r\n        x: 0,\r\n        y: 0,\r\n    },\r\n});\r\nexport var diagramScaleState = atom({\r\n    key: libraryPrefix + \"_DiagramScale\",\r\n    default: 1,\r\n});\r\nexport var diagramTransformationState = selector({\r\n    key: libraryPrefix + \"_DiagramTransformation\",\r\n    get: function (_a) {\r\n        var get = _a.get;\r\n        var scale = get(diagramScaleState);\r\n        var translate = get(diagramTranslateState);\r\n        return { scale: scale, translate: translate };\r\n    },\r\n    set: function (_a, newValue) {\r\n        var set = _a.set;\r\n        if (newValue instanceof DefaultValue) {\r\n        }\r\n        else {\r\n            set(diagramScaleState, newValue.scale);\r\n            set(diagramTranslateState, newValue.translate);\r\n        }\r\n    },\r\n});\r\nexport var commonSettingsState = atom({\r\n    key: libraryPrefix + \"_CommonSettings\",\r\n    default: {\r\n        readonly: false,\r\n    },\r\n});\r\n//# sourceMappingURL=diagramState.js.map","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport React, { useEffect, useRef } from 'react';\r\nimport { useRecoilCallback, useRecoilValue } from 'recoil';\r\nimport { defaultNodeType } from '..';\r\nimport { useNodeState } from '../hooks/nodeHooks';\r\nimport { useDragAndZoom } from '../hooks/useDragAndZoom';\r\nimport { useNotifyRef } from '../hooks/useNotifyRef';\r\nimport { diagramScaleState } from '../states/diagramState';\r\nimport { nodeComponentDefinitionState } from '../states/nodesSettingsState';\r\nexport var NodeWrapper = function (props) {\r\n    var _a;\r\n    var _b = useNodeState(props.id), node = _b[0], setNode = _b[1];\r\n    var nodeComponentDefinition = useRecoilValue(nodeComponentDefinitionState((_a = node.type) !== null && _a !== void 0 ? _a : defaultNodeType));\r\n    var nodeRef = useNotifyRef(null);\r\n    var draggableRef = useRef(null);\r\n    useEffect(function () {\r\n        setNode(function (curValue) { return (__assign(__assign({}, curValue), { ref: nodeRef })); });\r\n    }, [nodeRef]);\r\n    var getScale = useRecoilCallback(function (_a) {\r\n        var snapshot = _a.snapshot;\r\n        return function () {\r\n            var scaleState = snapshot.getLoadable(diagramScaleState).contents;\r\n            return typeof scaleState === 'number' ? scaleState : 1;\r\n        };\r\n    });\r\n    var _c = useDragAndZoom({\r\n        elemToAttachTo: draggableRef,\r\n        parentScale: getScale(),\r\n        initTranslate: node.position,\r\n    }), transform = _c.transform, translate = _c.translate;\r\n    useEffect(function () {\r\n        setNode(function (currentNode) {\r\n            return __assign(__assign({}, currentNode), { position: translate });\r\n        });\r\n    }, [translate]);\r\n    return (React.createElement(\"div\", { id: node.id, className: 'react_fast_diagram_NodeWrapper', style: {\r\n            transform: transform,\r\n        }, ref: nodeRef },\r\n        React.createElement(nodeComponentDefinition.component, { ref: draggableRef, node: node, setNode: setNode, settings: nodeComponentDefinition.settings })));\r\n};\r\nexport var NodeWrapperMemo = React.memo(NodeWrapper);\r\n//# sourceMappingURL=NodeWrapper.js.map","import React from 'react';\r\nimport { useRecoilState } from 'recoil';\r\nimport { nodesIdsState } from '../states/nodeState';\r\nimport { NodeWrapperMemo } from './NodeWrapper';\r\nvar NodesLayer = function () {\r\n    var nodes = useRecoilState(nodesIdsState)[0];\r\n    return (React.createElement(\"div\", null, nodes.map(function (id) { return (React.createElement(NodeWrapperMemo, { key: id, id: id })); })));\r\n};\r\nexport var NodesLayerMemorized = React.memo(NodesLayer);\r\n//# sourceMappingURL=NodesLayer.js.map","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { commonSettingsState, defaultLinkType, linksIdsState, linkWithIdState, nodesIdsState, nodeWithIdState, } from '..';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { nodesSettingsState } from './nodesSettingsState';\r\nimport { linksSettingsState } from './linksSettingsState';\r\nexport function initializeDiagram(snap, settings, initState) {\r\n    initializeSettings(snap, settings);\r\n    initializeState(snap, initState);\r\n}\r\nexport function initializeState(snap, initializer) {\r\n    if (!initializer) {\r\n        return;\r\n    }\r\n    initializeNodesState(snap, initializer.nodes);\r\n    initializeLinksState(snap, initializer.links);\r\n}\r\nexport function initializeSettings(snap, settings) {\r\n    if (!settings) {\r\n        return;\r\n    }\r\n    if (settings.common) {\r\n        snap.set(commonSettingsState, settings.common);\r\n    }\r\n    if (settings.nodes) {\r\n        snap.set(nodesSettingsState, settings.nodes);\r\n    }\r\n    if (settings.links) {\r\n        snap.set(linksSettingsState, settings.links);\r\n    }\r\n}\r\nexport function initializeNodesState(snap, nodes) {\r\n    nodes.forEach(function (node) {\r\n        snap.set(nodeWithIdState(node.id), node);\r\n    });\r\n    snap.set(nodesIdsState, nodes.map(function (node) { return node.id; }));\r\n}\r\nexport function initializeLinksState(snap, links) {\r\n    var linksIds = [];\r\n    links.forEach(function (linkOriginal) {\r\n        var _a;\r\n        var link = __assign({ type: defaultLinkType, id: (_a = linkOriginal.id) !== null && _a !== void 0 ? _a : uuidv4() }, linkOriginal);\r\n        linksIds.push(link.id);\r\n        snap.set(linkWithIdState(link.id), link);\r\n    });\r\n    snap.set(linksIdsState, linksIds);\r\n}\r\n//# sourceMappingURL=initializers.js.map","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport React, { forwardRef, useEffect, useImperativeHandle, } from 'react';\r\nimport { useRecoilCallback, useSetRecoilState } from 'recoil';\r\nimport { LinksLayerMemorized } from './LinksLayer';\r\nimport { NodesLayerMemorized } from './NodesLayer';\r\nimport { diagramScaleState } from '../states/diagramState';\r\nimport { nodesIdsState, nodeWithIdState } from '../states/nodeState';\r\nimport { linksIdsState, linkWithIdState } from '../states/linkState';\r\nimport { useNotifyRef } from '../hooks/useNotifyRef';\r\nimport { useDragAndZoom } from '../hooks/useDragAndZoom';\r\nimport { initializeState } from '../states/initializers';\r\nexport var InnerDiagram = forwardRef(function (props, ref) {\r\n    var movableElementRef = useNotifyRef(null);\r\n    var setScale = useSetRecoilState(diagramScaleState);\r\n    var _a = useDragAndZoom({\r\n        elemToAttachTo: movableElementRef,\r\n        enableZoom: true,\r\n        listenOnlyClass: 'react_fast_diagram_DiagramInner',\r\n    }), transform = _a.transform, scale = _a.scale;\r\n    useEffect(function () {\r\n        setScale(scale);\r\n    }, [scale]);\r\n    // TODO: Move to states\r\n    var addNode = useRecoilCallback(function (_a) {\r\n        var set = _a.set;\r\n        return function (newNode) {\r\n            set(nodeWithIdState(newNode.id), newNode);\r\n            set(nodesIdsState, function (v) { return v.concat([newNode.id]); });\r\n        };\r\n    });\r\n    var reinitState = useRecoilCallback(function (_a) {\r\n        var snapshot = _a.snapshot, gotoSnapshot = _a.gotoSnapshot;\r\n        return function (initializer) {\r\n            gotoSnapshot(snapshot.map(function (m) {\r\n                var nodeIds = m.getLoadable(nodesIdsState).contents;\r\n                if (Array.isArray(nodeIds)) {\r\n                    nodeIds.forEach(function (id) { return m.reset(nodeWithIdState(id)); });\r\n                }\r\n                var linksIds = m.getLoadable(linksIdsState).contents;\r\n                if (Array.isArray(linksIds)) {\r\n                    linksIds.forEach(function (id) { return m.reset(linkWithIdState(id)); });\r\n                }\r\n                initializeState(m, initializer);\r\n            }));\r\n        };\r\n    });\r\n    useImperativeHandle(ref, function () { return ({\r\n        addNode: addNode,\r\n        setState: reinitState,\r\n    }); }, []);\r\n    return (React.createElement(\"div\", { ref: movableElementRef, style: __assign({ touchAction: 'none' }, props.diagramStyles), className: 'react_fast_diagram_DiagramInner' },\r\n        React.createElement(\"div\", { className: 'react_fast_diagram_DiagramInner_DraggablePart', style: {\r\n                transform: transform,\r\n            } },\r\n            React.createElement(LinksLayerMemorized, null),\r\n            React.createElement(NodesLayerMemorized, null))));\r\n});\r\nInnerDiagram.displayName = 'InnerDiagram';\r\n//# sourceMappingURL=DiagramInner.js.map","import React, { forwardRef, useCallback } from 'react';\r\nimport { RecoilRoot } from 'recoil';\r\nimport { InnerDiagram } from './DiagramInner';\r\nimport { initializeDiagram, } from '../states/initializers';\r\nimport '../Diagram.css';\r\nexport var Diagram = forwardRef(function (props, ref) {\r\n    var initializeDiagramWrapper = useCallback(function (snap) {\r\n        return initializeDiagram(snap, props.settings, props.initState);\r\n    }, []);\r\n    return (React.createElement(RecoilRoot, { initializeState: initializeDiagramWrapper },\r\n        React.createElement(InnerDiagram, { ref: ref })));\r\n});\r\nDiagram.displayName = 'Diagram';\r\n//# sourceMappingURL=Diagram.js.map","import React, { useState } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { Tune } from '@material-ui/icons';\r\nimport Card from '@material-ui/core/Card';\r\nimport { Box, Button, TextField, Typography } from '@material-ui/core';\r\nimport { IDiagramInitState } from '@react-easy-diagram/core';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  form: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    gap: '7px',\r\n  },\r\n  visibilityBtn: {\r\n    borderRadius: '25px',\r\n    minWidth: '24px',\r\n    padding: '8px 8px',\r\n    backgroundColor: 'white',\r\n  },\r\n  header: {\r\n    marginBottom: '15px',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '14px',\r\n  },\r\n}));\r\n\r\nconst generateLargeDiagram = (colNum: number, rowNum: number): IDiagramInitState => {\r\n  const nodes = [];\r\n  const links = [];\r\n  const getNodeId = (i: number,j: number) => `node_${i}_${j}`;\r\n\r\n  for (let i = 0; i < colNum; i++) {\r\n    for (let j = 0; j < rowNum; j++) {\r\n      nodes.push({\r\n        id: getNodeId(i,j),\r\n        position: { x: i * 120, y: j * 120 },\r\n      });\r\n      if (i - 1 >= 0) {\r\n        links.push({\r\n          source: {\r\n            nodeId: getNodeId(i - 1,j)\r\n          },\r\n          target: {\r\n            nodeId: getNodeId(i,j)\r\n          }\r\n        });\r\n      }\r\n      if (j - 1 >= 0) {\r\n        links.push({\r\n          source: {\r\n            nodeId: getNodeId(i,j - 1)\r\n          },\r\n          target: {\r\n            nodeId: getNodeId(i,j)\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  return {nodes,links};\r\n};\r\n\r\nexport interface ControlPanelProps{\r\n  reinitState?(initializer: IDiagramInitState): void;\r\n}\r\n\r\nexport const ControlPanel = (props: ControlPanelProps) => {\r\n  const classes = useStyles();\r\n\r\n  const [row, setRow] = useState(10);\r\n  const [col, setCol] = useState(10);\r\n\r\n  const [visible, setVisible] = useState(true);\r\n\r\n  const onFormSubmit = (e: React.FormEvent<HTMLFormElement>) => {\r\n    if (props.reinitState) {\r\n      props.reinitState(generateLargeDiagram(row, col));\r\n    }\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  };\r\n\r\n  if (visible) {\r\n    return (\r\n      <Box padding={3} clone>\r\n        <Card>\r\n          <div className={classes.header}>\r\n            <Button\r\n              className={classes.visibilityBtn}\r\n              variant='outlined'\r\n              aria-label='control-panel'\r\n              onClick={() => setVisible(false)}\r\n            >\r\n              <Tune />\r\n            </Button>\r\n            <Typography variant='h5'>Control Panel</Typography>\r\n          </div>\r\n          <form\r\n            className={classes.form}\r\n            noValidate\r\n            autoComplete='off'\r\n            onSubmit={onFormSubmit}\r\n          >\r\n            <TextField\r\n              id='rows'\r\n              value={row}\r\n              type='number'\r\n              label='Rows'\r\n              variant='outlined'\r\n              onChange={(e) => setRow(parseInt(e.target.value))}\r\n            />\r\n            <TextField\r\n              id='columns'\r\n              value={col}\r\n              type='number'\r\n              label='Columns'\r\n              variant='outlined'\r\n              onChange={(e) => setCol(parseInt(e.target.value))}\r\n            />\r\n            <Button variant='contained' type='submit'>\r\n              Generate new Diagram\r\n            </Button>\r\n          </form>\r\n        </Card>\r\n      </Box>\r\n    );\r\n  } else {\r\n    return (\r\n      <Button\r\n        variant='outlined'\r\n        className={classes.visibilityBtn}\r\n        aria-label='control-panel'\r\n        onClick={() => setVisible(true)}\r\n      >\r\n        <Tune />\r\n      </Button>\r\n    );\r\n  }\r\n};\r\n","import React from 'react';\r\nimport './App.css';\r\nimport {\r\n  IDiagramInitState,\r\n  useDiagram,\r\n} from '@react-easy-diagram/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { Box } from '@material-ui/core';\r\nimport { ControlPanel } from './ControlPanel';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  diagram: {\r\n    height: '100vh',\r\n    width: '100vw',\r\n    backgroundColor: '#dbdbdb',\r\n    backgroundImage:\r\n      \"url(\\\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.3'%3E%3Cpath opacity='.5' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3Cpath d='M6 5V0H5v5H0v1h5v94h1V6h94V5H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\\\")\",\r\n  },\r\n  controlPanel: {\r\n    position: 'absolute',\r\n    top: '20px',\r\n    left: '20px',\r\n  },\r\n}));\r\n\r\nexport const App = () => {\r\n  const classes = useStyles();\r\n  const { Diagram, apiRef } = useDiagram(\r\n    {\r\n    },\r\n    initState\r\n  );\r\n\r\n  return (\r\n    <Box className={classes.diagram}>\r\n      <Diagram />\r\n      <Box className={classes.controlPanel}>\r\n        <ControlPanel reinitState={apiRef.current?.setState} />\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nconst initState: IDiagramInitState = {\r\n  nodes: [\r\n    {\r\n      id: 'Node 1',\r\n      position: {\r\n        x: 300,\r\n        y: 300,\r\n      },\r\n    },\r\n    {\r\n      id: 'Node 2',\r\n      position: {\r\n        x: 520,\r\n        y: 400,\r\n      },\r\n    },\r\n    {\r\n      id: 'Node 3',\r\n      position: {\r\n        x: 520,\r\n        y: 200,\r\n      },\r\n    },\r\n  ],\r\n  links: [\r\n    {\r\n      source: {\r\n        nodeId: 'Node 2',\r\n      },\r\n      target: {\r\n        nodeId: 'Node 1',\r\n      },\r\n    },\r\n  ],\r\n};\r\n","import React, { useMemo } from 'react';\r\nimport { Diagram } from '../components/Diagram';\r\nimport { useNotifyRef } from './useNotifyRef';\r\nexport var useDiagram = function (settings, initState) {\r\n    var apiRef = useNotifyRef(null);\r\n    var obj = useMemo(function () { return ({\r\n        Diagram: function () { return (React.createElement(Diagram, { ref: apiRef, initState: initState, settings: settings })); },\r\n        apiRef: apiRef,\r\n    }); }, []);\r\n    return obj;\r\n};\r\n//# sourceMappingURL=useDiagram.js.map","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport {App} from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}