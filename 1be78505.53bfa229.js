(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{141:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(3),o=n(7),i=n(0),a=n(143),u=n(86),c=n(142),s=n(68),l=n.n(s);function d(t){var e=t.children,n=t.theme,u=t.transformCode,c=Object(o.a)(t,["children","theme","transformCode"]);return i.createElement(a.d,Object(r.a)({code:e.replace(/\n$/,""),transformCode:u||function(t){return t+";"},theme:n},c),i.createElement("div",{className:l.a.playgroundPreview},i.createElement(a.c,null)),i.createElement(f,null))}function f(){return i.createElement(i.Fragment,null,i.createElement(p,{translateId:"theme.Playground.liveEditor",description:"The live editor label of the live codeblocks",text:"Live Editor"}),i.createElement(a.a,{className:l.a.playgroundEditor}),i.createElement(a.b,null))}function p(t){var e=t.translateId,n=t.description,r=t.text;return i.createElement("div",{className:Object(u.a)(l.a.playgroundHeader)},i.createElement(c.a,{id:e,description:n},r))}},179:function(t,e,n){"use strict";var r={};n.r(r),n.d(r,"BackgroundWrapper",(function(){return Xt})),n.d(r,"Callbacks",(function(){return A})),n.d(r,"DISABLED_USER_SELECT_CSS_CLASS",(function(){return R})),n.d(r,"Diagram",(function(){return Kt})),n.d(r,"DiagramSettings",(function(){return tt})),n.d(r,"DiagramState",(function(){return ot})),n.d(r,"HtmlElementRefState",(function(){return rt})),n.d(r,"InnerDiagram",(function(){return Yt})),n.d(r,"LinkCreationState",(function(){return at})),n.d(r,"LinkDefault",(function(){return st})),n.d(r,"LinkPointEndpointState",(function(){return ct})),n.d(r,"LinkPortEndpointState",(function(){return H})),n.d(r,"LinkState",(function(){return Rt})),n.d(r,"LinkWrapper",(function(){return At})),n.d(r,"LinksLayer",(function(){return Gt})),n.d(r,"LinksSettings",(function(){return ft})),n.d(r,"LinksStore",(function(){return gt})),n.d(r,"MiniControlWrapper",(function(){return qt})),n.d(r,"NodeDefault",(function(){return kt})),n.d(r,"NodeState",(function(){return zt})),n.d(r,"NodeWrapper",(function(){return Zt})),n.d(r,"NodesLayer",(function(){return Ut})),n.d(r,"NodesSettings",(function(){return Et})),n.d(r,"NodesStore",(function(){return It})),n.d(r,"PortDefault",(function(){return jt})),n.d(r,"PortState",(function(){return ht})),n.d(r,"PortWrapper",(function(){return _t})),n.d(r,"PortsSettings",(function(){return Lt})),n.d(r,"RelativePosition",(function(){return G})),n.d(r,"RootStore",(function(){return Dt})),n.d(r,"RootStoreContext",(function(){return Jt})),n.d(r,"RubbishBinButton",(function(){return ee})),n.d(r,"SelectionState",(function(){return Tt})),n.d(r,"VisualComponentState",(function(){return X})),n.d(r,"VisualComponentWithDefault",(function(){return $})),n.d(r,"VisualComponents",(function(){return Nt})),n.d(r,"addPoints",(function(){return E})),n.d(r,"allTouchTargetsContainsClass",(function(){return b})),n.d(r,"arePointsEqual",(function(){return j})),n.d(r,"areTranformationsEqual",(function(){return x})),n.d(r,"canDragGestureBeTapInstead",(function(){return S})),n.d(r,"clampValue",(function(){return w})),n.d(r,"componentDefaultType",(function(){return Mt})),n.d(r,"createCrossesImageGenerator",(function(){return p})),n.d(r,"createCurvedLinkPathConstructor",(function(){return U})),n.d(r,"createDefaultBackground",(function(){return m})),n.d(r,"createDefaultMiniControl",(function(){return re})),n.d(r,"createDotsImageGenerator",(function(){return f})),n.d(r,"createFullPortId",(function(){return mt})),n.d(r,"createGridImageGenerator",(function(){return d})),n.d(r,"createLinkDefault",(function(){return dt})),n.d(r,"createLinkPath",(function(){return Bt})),n.d(r,"createNodeDefault",(function(){return Pt})),n.d(r,"createPortDefault",(function(){return wt})),n.d(r,"createPortsContainerDefault",(function(){return yt})),n.d(r,"createStraightLinkPathConstructor",(function(){return Y})),n.d(r,"deepCopy",(function(){return N})),n.d(r,"distanceBetweenPoints",(function(){return O})),n.d(r,"errorResult",(function(){return Q})),n.d(r,"eventPathContainsClass",(function(){return _})),n.d(r,"eventTargetContainsClass",(function(){return y})),n.d(r,"generateTransform",(function(){return k})),n.d(r,"guid",(function(){return T})),n.d(r,"guidForcedUniqueness",(function(){return D})),n.d(r,"linkCreationComponentType",(function(){return ut})),n.d(r,"linkPortEndpointsEquals",(function(){return W})),n.d(r,"multiplyPoint",(function(){return I})),n.d(r,"roundPoint",(function(){return P})),n.d(r,"subtractPoints",(function(){return z})),n.d(r,"successResult",(function(){return J})),n.d(r,"successValueResult",(function(){return K})),n.d(r,"useDiagram",(function(){return v})),n.d(r,"useDiagramDragHandlers",(function(){return C})),n.d(r,"useDiagramPinchHandlers",(function(){return M})),n.d(r,"useDiagramUserInteraction",(function(){return V})),n.d(r,"useDiagramWheelHandler",(function(){return F})),n.d(r,"useLinkUserInteraction",(function(){return Ft})),n.d(r,"useNodeUserInteraction",(function(){return Ht})),n.d(r,"useNotifyRef",(function(){return g})),n.d(r,"usePortUserInteraction",(function(){return vt})),n.d(r,"useRootStore",(function(){return Qt})),n.d(r,"useUserAbilityToSelectSwitcher",(function(){return B}));var o=n(0),i=n.n(o),a=n(180),u=n(176),c=n(101),s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},l=function(t){var e=t.diagramOffset,n=t.diagramZoom,r=t.settings,a=null!=r?r:h,u=Object(o.useMemo)((function(){return a.imageGenerator?a.imageGenerator(100*n,100*n):void 0}),[a,a.imageGenerator,n]);return i.a.createElement("div",{className:"react_fast_diagram_Background_Default",style:{backgroundColor:a.color,backgroundImage:u,backgroundPosition:e[0]+"px "+e[1]+"px"}})},d=function(t,e,n){return function(r,o){return function(t,e,n,r,o){return"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='"+t*n+"' height='"+e*n+"' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='"+(r=r.replace("#","%23"))+"' fill-opacity='"+o+"'%3E%3Cpath opacity='.5' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3Cpath d='M6 5V0H5v5H0v1h5v94h1V6h94V5H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")"}(r,o,t,e,n)}},f=function(t,e,n,r){return function(o,i){return function(t,e,n,r,o,i){return"url(\"data:image/svg+xml,%3Csvg width='"+t*(n*=.1)+"' height='"+e*n+"' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='"+(r=r.replace("#","%23"))+"' fill-opacity='"+o+"' fill-rule='evenodd'%3E%3Ccircle cx='3' cy='3' r='"+i+"'/%3E%3Ccircle cx='13' cy='13' r='"+i+"'/%3E%3C/g%3E%3C/svg%3E\")"}(o,i,t,e,n,r)}},p=function(t,e,n){return function(r,o){return function(t,e,n,r,o){return"url(\"data:image/svg+xml,%3Csvg width='"+t*n+"' height='"+e*n+"' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='"+(r=r.replace("#","%23"))+"' fill-opacity='"+o+"'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")"}(r,o,t,e,n)}},h={imageGenerator:p(.2,"#858585",.1),color:"#ffffff"},m=function(t){var e=s(s({},h),t||{});return{component:l,settings:e}},g=function(t){var e=Object(o.useState)(0);e[0];var n=e[1],r=Object(o.useState)((function(){return{value:t,facade:{get current(){return r.value},set current(t){r.value!==t&&(r.value=t,n((function(t){return t+1})))}}}}))[0];return r.facade},v=function(t,e){var n=g(null);return Object(o.useMemo)((function(){return{Diagram:function(){return i.a.createElement(Kt,{storeRef:n,initState:t,settings:e})},storeRef:n}}),[])},_=function(t,e){if("composedPath"in t)for(var n=t.composedPath(),r=0;r<n.length;r++){var o=n[r];if("classList"in o&&o.classList.contains(e))return!0}return!1};function b(t,e,n){for(var r=0;r<t.touches.length;r++)if(!y(t.touches[r].target,e,n))return!1;return!0}function y(t,e,n){if(t&&"classList"in t){var r=t;return(!e||r.classList.contains(e))&&(!n||!r.classList.contains(n))}return!1}function S(t){return Math.max(Math.abs(t[0]),Math.abs(t[1]))<3}function C(t,e,n,r){var i=Qt();return Object(o.useMemo)((function(){return{onDrag:function(r){var o=r.pinching,i=r.delta;if(t.current&&!o){var a=e();n([a[0]+i[0],a[1]+i[1]])}},onDragStart:function(e){var n=e.event;r&&r(n)||(t.current=!0)},onDragEnd:function(e){var n=e.tap;t.current&&(t.current=!1,n&&i.selectionState.clear())}}}),[t,e,n,r,i])}var k=function(t,e){var n="translate("+t[0]+"px, "+t[1]+"px)";return e?n+" "+("scale("+e+")"):n},O=function(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))},P=function(t){return[Math.round(t[0]),Math.round(t[1])]},E=function(t,e){return[t[0]+e[0],t[1]+e[1]]},z=function(t,e){return[t[0]-e[0],t[1]-e[1]]},I=function(t,e){return[t[0]*e,t[1]*e]},j=function(t,e){return t===e||t&&e&&t[0]===e[0]&&t[1]===e[1]},x=function(t,e){return t===e||t&&e&&t.zoom===e.zoom&&j(t.offset,e.offset)};function w(t,e){return Math.min(Math.max(t,e[0]),e[1])}function L(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function T(){return L()+L()+"-"+L()+"-"+L()+"-"+L()+"-"+L()+L()+L()}function D(t){for(var e=T();e in t;)e=T();return e}function N(t){return JSON.parse(JSON.stringify(t))}function M(t,e,n,r){var i=Object(o.useRef)({distance:0,origin:[0,0]});return Object(o.useMemo)((function(){return{onPinch:function(r){var o=r.da[0],a=r.origin;if(e.current&&t.current){var u=z(a,i.current.origin),c=t.current.getBoundingClientRect(),s=z(a,[c.left,c.top]);n.tranlsateAndZoomInto(u,s,o/i.current.distance),i.current={distance:o,origin:a}}},onPinchStart:function(t){var n=t.da[0],o=t.origin,a=t.event;r(a)||(i.current={distance:n,origin:o},e.current=!0)},onPinchEnd:function(){return e.current=!1}}}),[t,e,n,r])}var R="react_fast_diagram_disabled_user_select";function B(t,e){Object(o.useEffect)((function(){if(t&&e&&!e.classList.contains(R))return e.classList.add(R),function(){e.classList.remove(R)}}),[t,e])}function F(t,e,n){return Object(o.useMemo)((function(){return{onWheel:function(e){var r=e.direction;r[0];var o=r[1],i=e.event,a=i.clientX,u=i.clientY;if(t.current){null===event||void 0===event||event.preventDefault();var c=t.current.getBoundingClientRect(),s=z([a,u],[c.left,c.top]),l=.9;o<0&&(l=1/l),n.tranlsateAndZoomInto([0,0],s,l)}}}}),[t,e,n])}var V=function(t){var e,n,r=Qt().diagramState,i=g(!1),a=Object(o.useCallback)((function(t){return t.target!==r.diagramInnerRef.current}),[r.diagramInnerRef]),c=C(i,Object(o.useCallback)((function(){return r.offset}),[r]),Object(o.useCallback)(r.setOffset,[r]),a),l=M(r.diagramInnerRef,i,r,a),d=F(r.diagramInnerRef,i,r);return Object(u.a)(s(s(s({},c),l),d),{domTarget:r.diagramInnerRef,eventOptions:{passive:!1},enabled:t}),B(i.current,null===(n=null===(e=r.diagramInnerRef.current)||void 0===e?void 0:e.ownerDocument)||void 0===n?void 0:n.body),{transform:r.transformString,active:i.current}},H=function(){function t(t,e,n){var r=this;this.export=function(){return N({nodeId:r._nodeId,portId:r._portId})},this._nodeId=t,this._portId=e,n.nodesStore.getNodeOrThrowException(this._nodeId).getPortOrThrowException(this._portId),Object(c.c)(this),this._rootStore=n}return Object.defineProperty(t.prototype,"nodeId",{get:function(){return this._nodeId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"portId",{get:function(){return this._portId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"node",{get:function(){return this._rootStore.nodesStore.getNodeOrThrowException(this._nodeId)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"port",{get:function(){return this.node.getPortOrThrowException(this._portId)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"point",{get:function(){if(this.port.offsetRelativeToNode&&this.port.realSize)return E(this.node.position,E(this.port.offsetRelativeToNode,I(this.port.realSize,.5)))},enumerable:!1,configurable:!0}),t}();function W(t,e){return t.nodeId===e.nodeId&&t.portId===e.portId}var A=function(){function t(t){var e=this;this.import=function(t){e._validateLinkEndpoints=null==t?void 0:t.validateLinkEndpoints},this.export=function(){return{validateLinkEndpoints:e._validateLinkEndpoints}},this._rootStore=t}return Object.defineProperty(t.prototype,"validateLinkEndpoints",{get:function(){return this._validateLinkEndpoints},enumerable:!1,configurable:!0}),t}();var G,Z={portTypeToLinkDirectionMapping:{left:"left",right:"right",top:"up",bottom:"down"},directionFactor:60,tweakDirectionFactorBasedOnDistance:function(t,e){return t<100?e*(t/100):e}};function U(t){return function(e,n,r,o){return function(t,e,n,r,o){if(!t||!e)return"";t=P(t),e=P(e);var i=t[0]+", "+t[1],a=e[0]+", "+e[1],u=o.tweakDirectionFactorBasedOnDistance(O(t,e),o.directionFactor);function c(t,e){switch(e&&o.portTypeToLinkDirectionMapping[e]){case"left":return t[0]-u+", "+t[1];case"up":return t[0]+", "+(t[1]-u);case"right":return t[0]+u+", "+t[1];case"down":return t[0]+", "+(t[1]+u);default:return t[0]+", "+t[1]}}return n||r?"M "+i+" C "+c(t,n)+" "+c(e,r)+", "+a:"M "+i+" Q "+e[0]+", "+t[1]+", "+a}(e,n,r,o,t?s(s({},Z),t):Z)}}function q(t,e,n,r){return"M "+t[0]+" "+t[1]+", "+e[0]+" "+e[1]}function Y(){return q}function J(){return{success:!0}}function K(t){return{success:!0,value:t}}function Q(t){return{success:!1,error:t}}!function(t){t.left="left",t.top="top",t.right="right",t.bottom="bottom"}(G||(G={}));var X=function(){function t(t){var e=this;this._settings={},this.import=function(t){var n;"component"in t?(e._component=Object(a.a)(t.component),e._settings=null!==(n=t.settings)&&void 0!==n?n:{}):(e._component=Object(a.a)(t),e._settings={})},this.import(t),Object(c.c)(this)}return Object.defineProperty(t.prototype,"component",{get:function(){return this._component},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"settings",{get:function(){return this._settings},enumerable:!1,configurable:!0}),t}(),$=function(){function t(t){var e=this;this.import=function(t){e._innerComponent=t?new X(t):e._defaultComponent},this._innerComponent=new X(t),this._defaultComponent=this._innerComponent,Object(c.c)(this)}return Object.defineProperty(t.prototype,"component",{get:function(){return this._innerComponent.component},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"settings",{get:function(){return this._innerComponent.settings},enumerable:!1,configurable:!0}),t}(),tt=function(){function t(){var t=this;this._zoomInterval=et,this._zoomToFitSettings=nt,this.import=function(e){t._backgroundComponentState.import(null==e?void 0:e.backgroundComponent),t._miniControlComponentState.import(null==e?void 0:e.miniControlComponent),t.setZoomInterval(null==e?void 0:e.zoomInterval),t._zoomToFitSettings=s(s({},nt),null==e?void 0:e.zoomToFitSettings)},this.setZoomInterval=function(e){t._zoomInterval=null!=e?e:et},this._backgroundComponentState=new $(m()),this._miniControlComponentState=new $(re()),Object(c.c)(this)}return Object.defineProperty(t.prototype,"backgroundComponentState",{get:function(){return this._backgroundComponentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miniControlComponentState",{get:function(){return this._miniControlComponentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoomInterval",{get:function(){return this._zoomInterval},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoomToFitSettings",{get:function(){return this._zoomToFitSettings},enumerable:!1,configurable:!0}),t}(),et=[.1,3],nt={padding:[30,30]},rt=function(){function t(t){var e=this;this.offsetRelativeToParent=function(t){if(e.current){for(var n=e.current,r=0,o=0;t!==n&&n;)r+=n.offsetLeft,o+=n.offsetTop,n=n.parentElement;return[r,o]}return null},this._currentInternal=t,Object(c.c)(this)}return Object.defineProperty(t.prototype,"current",{get:function(){return this._currentInternal},set:function(t){this._currentInternal=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realSize",{get:function(){return this.current?[this.current.clientWidth,this.current.clientHeight]:null},enumerable:!1,configurable:!0}),t}(),ot=function(){function t(t){var e=this;this.import=function(t){e.setOffset(null==t?void 0:t.offset),e.setZoom(null==t?void 0:t.zoom)},this.export=function(){return N({offset:e._offset,zoom:e._zoom})},this.setOffset=function(t){e._offset=null!=t?t:[0,0]},this.setZoom=function(t){e._zoom=w(null!=t?t:1,e._rootStore.diagramSettings.zoomInterval)},this.zoomIn=function(){return e._rootStore.diagramState.zoomIntoCenter(1.25)},this.zoomOut=function(){return e._rootStore.diagramState.zoomIntoCenter(.8)},this.setTransformation=function(t,n){e.setOffset(t),e.setZoom(n)},this.zoomInto=function(t,n){var r=w(e._zoom*n,e._rootStore.diagramSettings.zoomInterval),o=I(z(t,e._offset),r/e._zoom);e.setTransformation(z(t,o),r)},this.translate=function(t){e.setOffset(E(e._offset,t))},this.tranlsateAndZoomInto=function(t,n,r){e.translate(t),e.zoomInto(n,r)},this.zoomIntoCenter=function(t){var n=e._diagramInnerRef.realSize;n&&e._rootStore.diagramState.zoomInto(I(n,.5),t)},this.zoomToFit=function(){var t=e._getNodesBoundingBoxWithPadding(),n=e._diagramInnerRef.realSize;if(n){var r=function(t,e){return Math.min(t[0]/e.size[0],t[1]/e.size[1])}(n,t);e._rootStore.diagramSettings.setZoomInterval([Math.min(e._rootStore.diagramSettings.zoomInterval[0],r),Math.max(e._rootStore.diagramSettings.zoomInterval[1],r)]),e.setZoom(r),e.setOffset(function(t,e,n){var r=I(n.size,e),o=I(n.topLeftCorner,e),i=z(t,r);return E(I(o,-1),I(i,.5))}(n,r,t))}else console.warn("Cannot retrieve diagram size")},this._getNodesBoundingBoxWithPadding=function(){var t=e._rootStore.nodesStore.getNodesBoundingBox(),n=e._rootStore.diagramSettings.zoomToFitSettings.padding;return t.topLeftCorner=z(t.topLeftCorner,n),t.bottomRightCorner=E(t.bottomRightCorner,n),t.size=z(t.bottomRightCorner,t.topLeftCorner),t},this._diagramInnerRef=new rt(null),this._rootStore=t,this.import(),Object(c.c)(this,{_rootStore:!1})}return Object.defineProperty(t.prototype,"transformString",{get:function(){return k(this._offset,this._zoom)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"diagramInnerRef",{get:function(){return this._diagramInnerRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offset",{get:function(){return this._offset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoom",{get:function(){return this._zoom},enumerable:!1,configurable:!0}),t}();var it=function(){function t(t){var e=this;this.translateBy=function(t){e._point=E(e._point,t)},this._point=t,Object(c.c)(this)}return Object.defineProperty(t.prototype,"point",{get:function(){return this._point},enumerable:!1,configurable:!0}),t}(),at=function(){function t(t){var e=this;this._source=null,this._target=null,this._targetPortCandidate=null,this.startLinking=function(t,n){e._resetProps(),e._source=new H(t.nodeId,t.id,e._rootStore);var r=e._source.point,o=e._source.port.realSize;if(!r||!o)return e._resetProps(),!1;var i=z(r,I(o,.5));return e._target=new it(E(i,I(n,1/e._rootStore.diagramState.zoom))),!0},this.setTargetPortCandidate=function(t){if(e._source){var n=e._rootStore.linksStore.canAddLink({source:{nodeId:e._source.nodeId,portId:e._source.portId},target:{nodeId:t.nodeId,portId:t.id}});e._targetPortCandidate=t,n.success?t.validForConnection=!0:t.validForConnection=!1}},this.resetTargetPortCandidate=function(t){e._targetPortCandidate===t&&(e._targetPortCandidate=null),t.validForConnection=!0},this.stopLinking=function(){if(e._targetPortCandidate&&e._source){var t=e._rootStore.linksStore.addLink({source:{nodeId:e._source.nodeId,portId:e._source.portId},target:{nodeId:e._targetPortCandidate.nodeId,portId:e._targetPortCandidate.id}});t.success&&e._rootStore.selectionState.select(t.value,!1)}e._resetProps()},this._resetProps=function(){e._source&&(e._source.port.validForConnection=!0,e._source=null),e._target=null,e._targetPortCandidate&&(e._targetPortCandidate.validForConnection=!0,e._targetPortCandidate=null)},Object(c.c)(this),this._rootStore=t}return Object.defineProperty(t.prototype,"selected",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hovered",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetPortCandidate",{get:function(){return this._targetPortCandidate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"componentDefinition",{get:function(){return this._rootStore.linksSettings.visualComponents.getComponent(ut)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._source&&this._target?Bt(this._rootStore,this._source,this._target):void 0},enumerable:!1,configurable:!0}),t}(),ut="linkCreation",ct=function(){function t(t){var e=this;this.translateBy=function(t){e._point=E(e._point,t)},this._point=t,Object(c.c)(this)}return Object.defineProperty(t.prototype,"point",{get:function(){return this._point},enumerable:!1,configurable:!0}),t}(),st=function(t){var e=t.entity,n=t.settings,r=t.bind,o=s(s({},lt),n),a=e.path;if(!a)return null;var u=o.color;return e.selected&&(u=o.selectedColor),i.a.createElement("g",null,i.a.createElement("path",{d:a.svgPath,stroke:u,strokeWidth:o.strokeWidth,fill:"none",strokeLinecap:"round"}),i.a.createElement("path",s({d:a.svgPath,stroke:u,strokeWidth:o.strokeWidth+5},r(),{pointerEvents:"auto",fill:"none",strokeLinecap:"round",strokeOpacity:e.hovered?.22:0})),e instanceof at&&i.a.createElement("circle",{cx:a.target[0],cy:a.target[1],r:o.cirleRadius,fill:"orange"}))},lt={color:"#c2c2c2",selectedColor:"#6eb7ff",strokeWidth:1,cirleRadius:3};function dt(t){return{component:st,settings:t}}var ft=function(){function t(){var t,e=this;this._pathConstructor=pt,this._visualComponents=new Nt(((t={})[Mt]=st,t[ut]=st,t)),this.import=function(t){e._visualComponents.import(t),e.setPathConstructor(null==t?void 0:t.pathConstructor)},this.setPathConstructor=function(t){e._pathConstructor=null!=t?t:pt},Object(c.c)(this)}return Object.defineProperty(t.prototype,"pathConstructor",{get:function(){return this._pathConstructor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"visualComponents",{get:function(){return this._visualComponents},enumerable:!1,configurable:!0}),t}(),pt=U(),ht=function(){function t(t,e,n,r){var o=this;this._ref=new rt(null),this._dragging=!1,this._hovered=!1,this._validForConnection=!0,this.setLabel=function(t){o._label=null!=t?t:""},this.setType=function(t){o._type=null!=t?t:Mt},this.import=function(t){o.setType(null==t?void 0:t.type),o.setLabel(null==t?void 0:t.label),o.setExtra(null==t?void 0:t.extra)},this.export=function(){return N({id:o._id,nodeId:o._nodeId,label:o._label,type:o._type})},this.setExtra=function(t){o._extra=null!=t?t:null},this._id=e,this._nodeId=n,this.import(r),Object(c.c)(this),this._rootStore=t}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodeId",{get:function(){return this._nodeId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullId",{get:function(){return mt(this.nodeId,this.id)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return this._ref},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dragging",{get:function(){return this._dragging},set:function(t){this._dragging=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hovered",{get:function(){return this._hovered},set:function(t){this._hovered=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"validForConnection",{get:function(){return this._validForConnection},set:function(t){this._validForConnection=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extra",{get:function(){return this._extra},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"node",{get:function(){return this._rootStore.nodesStore.getNodeOrThrowException(this.nodeId)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetRelativeToNode",{get:function(){return this.node.ref.current?this._ref.offsetRelativeToParent(this.node.ref.current):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realSize",{get:function(){return this._ref.realSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"componentDefinition",{get:function(){return this._rootStore.portsSettings.portVisualComponents.getComponent(this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectedLinks",{get:function(){return this._rootStore.linksStore.getPortLinks(this.nodeId,this.id)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectedPorts",{get:function(){var t=this;return this.connectedLinks.map((function(e){return e.source.portId===t._id?e.target.port:e.source.port}))},enumerable:!1,configurable:!0}),t}();function mt(t,e){return t+"-"+e}var gt=function(){function t(t){var e=this;this.import=function(t){e._links=new Map,e._nodesLinksCollection=new Map,t&&t.forEach(e.addLink)},this.export=function(){return Array.from(e._links).map((function(t){return t[0],t[1].export()}))},this.getNodeLinks=function(t){var n;return null!==(n=e._nodesLinksCollection.get(t))&&void 0!==n?n:[]},this.getPortLinks=function(t,n){var r=e.getNodeLinks(t),o=mt(t,n);return r.filter((function(t){return t.source.port.fullId===o||t.target.port.fullId===o}))},this.removeNodeLinks=function(t){e.getNodeLinks(t).forEach((function(t){return e.removeLink(t.id)}))},this.removePortLinks=function(t,n){if(t&&n){var r=e.getNodeLinks(t),o={nodeId:t,portId:n};r.forEach((function(t){(W(t.source,o)||W(t.target,o))&&e.removeLink(t.id)}))}},this.addLink=function(t){var n,r=e.canAddLink(t);if(!r.success)return r;var o=new Rt(e._rootStore,null!==(n=t.id)&&void 0!==n?n:D(e._links),t);return e._links.set(o.id,o),e._addLinkToNodeLinksCollection(o,t.source.nodeId),e._addLinkToNodeLinksCollection(o,t.target.nodeId),K(o)},this.removeLink=function(t){var n=e._links.get(t);return!!n&&(e._removeLinkFromNodeLinksCollection(n,n.source.nodeId),e._removeLinkFromNodeLinksCollection(n,n.target.nodeId),e._rootStore.selectionState.unselect(n),e._links.delete(t),!0)},this.canAddLink=function(t){var n,r;if(!t)return Q("Cannot add empty");if(t.id&&e._links.has(t.id))return Q("Cannot add link with id '"+t.id+"', as it already exists");var o=e.isEndpointValid(t.source);if(!o.success)return o;var i=e.isEndpointValid(t.target);return i.success?t.source.nodeId===t.target.nodeId?Q("Link's endpoints are located in the same node"):e.areEndpointsConnected(t.source,t.target)?Q("Link's endpoints are already connected"):!1===(null===(r=(n=e._rootStore.callbacks).validateLinkEndpoints)||void 0===r?void 0:r.call(n,e.getEndpointPort(t.source),e.getEndpointPort(t.target),e._rootStore))?Q("Link's endpoints are not valid according to validation callback"):{success:!0}:i},this.isEndpointValid=function(t){try{e.getEndpointPort(t)}catch(n){return Q(""+n)}return{success:!0}},this.getEndpointPort=function(t){return e._rootStore.nodesStore.getNodeOrThrowException(t.nodeId).getPortOrThrowException(t.portId)},this.areEndpointsConnected=function(t,n){return!!e.getLinkForEndpointsIfExists(t,n)},this.getLinkForEndpointsIfExists=function(t,n){var r=e._nodesLinksCollection.get(t.nodeId);if(r)return r.find((function(e){return W(e.source,t)&&W(e.target,n)||W(e.target,t)&&W(e.source,n)}))},this._addLinkToNodeLinksCollection=function(t,n){var r=e._nodesLinksCollection.get(n);r?r.push(t):e._nodesLinksCollection.set(n,[t])},this._removeLinkFromNodeLinksCollection=function(t,n){var r=e._nodesLinksCollection.get(n);r&&((r=r.filter((function(e){return e.id!==t.id}))).length>0?e._nodesLinksCollection.set(n,r):e._nodesLinksCollection.delete(n))},this._linkCreation=new at(t),this.import(),Object(c.c)(this),this._rootStore=t}return Object.defineProperty(t.prototype,"links",{get:function(){return this._links},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linkCreation",{get:function(){return this._linkCreation},enumerable:!1,configurable:!0}),t}(),vt=function(t,e){var n,r,i=Qt(),a=i.linksStore.linkCreation,c=i.diagramState,s=Object(o.useRef)(null),l=Object(o.useMemo)((function(){return{onDrag:function(e){var n,r=e.delta;if(t.dragging){var o=c.zoom;null===(n=a.target)||void 0===n||n.translateBy(I(r,1/o))}},onDragStart:function(e){var n=e.event,r=e.xy,o=n.target;o.releasePointerCapture(n.pointerId);var i=z(r,[o.getBoundingClientRect().x,o.getBoundingClientRect().y]);a.startLinking(t,i)&&(t.dragging=!0)},onDragEnd:function(){t.dragging=!1,a.stopLinking()},onPointerEnter:function(){t.hovered=!0,a.setTargetPortCandidate(t)},onPointerLeave:function(){t.hovered=!1,a.resetTargetPortCandidate(t)}}}),[t,a]),d=Object(u.a)(l,{eventOptions:{passive:!1},enabled:e});return B(t.dragging,null===(r=null===(n=s.current)||void 0===n?void 0:n.ownerDocument)||void 0===r?void 0:r.body),{active:t.dragging,userInteractionElemRef:s,bind:d}},_t=Object(a.a)((function(t){var e=t.port,n=vt(e),r=n.userInteractionElemRef,o=n.bind;return i.a.createElement("div",s({ref:{set current(t){r.current=t,e.ref.current=t}}},o(),{id:e.nodeId+":"+e.id,className:"react_fast_diagram_PortWrapper"}),i.a.createElement(e.componentDefinition.component,{entity:e,settings:e.componentDefinition.settings}))})),bt=function(t){var e=t.position,n=t.ports,r=t.style,o=t.gapBetweenPorts,a=t.offsetFromOriginPosition,u="react_fast_diagram_flex_gap ";u+="top"===e||"bottom"===e?"react_fast_diagram_flex_gap_x":"react_fast_diagram_flex_gap_y";var c={position:"absolute",left:"left"===e?0:void 0,top:"left"===e||"right"===e||"top"===e?0:void 0,right:"right"===e?0:void 0,bottom:"bottom"===e?0:void 0,height:"left"===e||"right"===e?"100%":void 0,width:"top"===e||"bottom"===e?"100%":void 0},l={};return a&&Object.values(G).includes(e)&&(l[e]=-a),i.a.createElement("div",{className:u,style:s(s(s({"--gap":o},r),c),l)},n&&n.map((function(t){return i.a.createElement(_t,{key:t.id,port:t})})))};function yt(t){return function(e){return i.a.createElement(bt,s({},s(s({},St),t),e))}}var St={gapBetweenPorts:"8px"},Ct=Object(a.a)((function(t){var e=t.node;return i.a.createElement("span",null,e.label?e.label:e.id)})),kt=function(t){var e=t.entity,n=t.settings,r=t.draggableRef,o=s(s({},Ot),n),a=s(s({},o.style),e.selected?o.selectedStyle:void 0),u=new Map;return Object.values(e.ports).forEach((function(t){var e,n=function(t,e){var n;if(!t)return;return e?null!==(n=e[t])&&void 0!==n?n:t:Object.values(G).includes(t)?t:void 0}(t.type,o.portTypeToPositionMapping);n&&(u.has(n)?null===(e=u.get(n))||void 0===e||e.push(t):u.set(n,[t]))})),i.a.createElement("div",{ref:r,className:"react_fast_diagram_Node_Default",style:a},i.a.createElement(o.innerNode,{node:e}),Array.from(u).map((function(t){var e=t[0],n=t[1];return i.a.createElement(o.nodeContainer,{ports:n,position:e,key:e})})))};var Ot={selectedStyle:{border:"#6eb7ff solid 1px"},nodeContainer:yt({offsetFromOriginPosition:5}),innerNode:Ct};function Pt(t){return{component:kt,settings:s(s({},Ot),t)}}var Et=function(){function t(){var t,e=this;this._visualComponents=new Nt(((t={})[Mt]=kt,t)),this.import=function(t){e._visualComponents.import(t)},Object(c.c)(this)}return Object.defineProperty(t.prototype,"visualComponents",{get:function(){return this._visualComponents},enumerable:!1,configurable:!0}),t}(),zt=function(){function t(t,e,n){var r=this;this.import=function(t){var e;r.setPosition(null==t?void 0:t.position),r.setComponentType(null==t?void 0:t.componentType),r.setExtra(null==t?void 0:t.extra),r.label=null!==(e=null==t?void 0:t.label)&&void 0!==e?e:"",r._ports={},(null==t?void 0:t.ports)&&t.ports.forEach(r.addPort)},this.export=function(){return s(s({},N({id:r._id,label:r._label,position:r._position,componentType:r.componentType,extra:r.extra})),{ports:Object.values(r._ports).map((function(t){return t.export()}))})},this.setPosition=function(t){r._position=null!=t?t:[0,0]},this.setComponentType=function(t){r._componentType=null!=t?t:Mt},this.setExtra=function(t){r._extra=null!=t?t:null},this.getPort=function(t){return t&&r._ports[t]?r._ports[t]:void 0},this.addPort=function(t){var e;if(!t||t.id&&r._ports[t.id])return!1;var n=new ht(r._rootStore,null!==(e=t.id)&&void 0!==e?e:D(r._ports),r._id,t);return r._ports[n.id]=n,!0},this.removePort=function(t){return!(!t||!r._ports[t])&&(delete r._ports[t],r._rootStore.linksStore.removePortLinks(r._id,t),!0)},this.getPortOrThrowException=function(t){var e=r.getPort(t);if(e)return e;throw"Port with id '"+t+"' does not exist in the node '"+r._id+"'"},this._rootStore=t,this._id=e,this._ref=new rt(null),this._selected=!1,this.import(n),Object(c.c)(this,{_rootStore:!1})}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){return this._label},set:function(t){this._label=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"componentType",{get:function(){return this._componentType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extra",{get:function(){return this._extra},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return this._ref},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ports",{get:function(){return this._ports},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformString",{get:function(){return k(this._position)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"componentDefinition",{get:function(){return this._rootStore.nodesSettings.visualComponents.getComponent(this.componentType)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realSize",{get:function(){return this._ref.realSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectedExternalPorts",{get:function(){var t=Object.values(this.ports).map((function(t){return[t.id,t.connectedPorts]}));return Object.fromEntries(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectedLinks",{get:function(){return this._rootStore.linksStore.getNodeLinks(this._id)},enumerable:!1,configurable:!0}),t}(),It=function(){function t(t){var e=this;this._nodes=new Map,this.import=function(t){e._nodes=new Map,null==t||t.forEach((function(t){return e.addNode(t,!0)}))},this.export=function(){return Array.from(e._nodes).map((function(t){return t[0],t[1].export()}))},this.addNode=function(t,n){var r;if(!t||!n&&t.id&&e._nodes.has(t.id))return Q("");var o=new zt(e._rootStore,null!==(r=t.id)&&void 0!==r?r:D(e._nodes),t);return e._nodes.set(o.id,o),K(o)},this.removeNode=function(t){var n=e._nodes.get(t);return!!n&&(e._rootStore.linksStore.removeNodeLinks(t),e._rootStore.selectionState.unselect(n),e._nodes.delete(t),!0)},this.getNode=function(t){return e._nodes.get(t)},this.getNodeOrThrowException=function(t){var n=e.getNode(t);if(n)return n;throw"Node with id '"+t+"' does not exist"},this.getNodesBoundingBox=function(){var t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],n=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return e._nodes.forEach((function(e){var r,o=e.position,i=null!==(r=e.realSize)&&void 0!==r?r:[1,1];t[0]=Math.min(t[0],o[0]),t[1]=Math.min(t[1],o[1]),n[0]=Math.max(n[0],o[0]+i[0]),n[1]=Math.max(n[1],o[1]+i[1])})),{topLeftCorner:t,bottomRightCorner:n,size:z(n,t)}},Object(c.c)(this),this._rootStore=t}return Object.defineProperty(t.prototype,"nodes",{get:function(){return this._nodes},enumerable:!1,configurable:!0}),t}(),jt=function(t){var e=t.entity,n=t.settings,r=s(s({},xt),n),o=r.color;return e.dragging?o=r.dragColor:e.hovered&&e.validForConnection?o=r.hoverColor:e.hovered&&!e.validForConnection&&(o=r.invalidColor),i.a.createElement("div",{style:{width:r.size[0],height:r.size[1],backgroundColor:o,borderRadius:"2px"}})},xt={size:[10,10],color:"#6eb7ff",dragColor:"#49f860",hoverColor:"#49f860",invalidColor:"#fa4040"};function wt(t){return{component:jt,settings:s(s({},xt),t)}}var Lt=function(){function t(){var t,e=this;this._portVisualComponents=new Nt(((t={})[Mt]=wt(),t)),this.import=function(t){e.portVisualComponents.import({components:null==t?void 0:t.portComponents,defaultType:null==t?void 0:t.portDefaultType})},Object(c.c)(this)}return Object.defineProperty(t.prototype,"portVisualComponents",{get:function(){return this._portVisualComponents},enumerable:!1,configurable:!0}),t}(),Tt=function(){function t(t){var e=this;this._selectedItems=[],this.select=function(t,n){n?e._selectedItems.includes(t)?e.unselect(t):(t.selected=!0,e._selectedItems.push(t)):(e.clear(),t.selected=!0,e._selectedItems.push(t))},this.unselect=function(t){t.selected=!1,e._selectedItems=e._selectedItems.filter((function(e){return e!==t}))},this.clear=function(){e._selectedItems.forEach((function(t){return t.selected=!1})),e._selectedItems=[]},this.removeSelected=function(){e.removeSelectedNodes(),e.removeSelectedLinks()},this.removeSelectedNodes=function(){e._selectedItems.filter((function(t){return t instanceof zt})).forEach((function(t){e._rootStore.nodesStore.removeNode(t.id)}))},this.removeSelectedLinks=function(){e._selectedItems.filter((function(t){return t instanceof Rt})).forEach((function(t){e._rootStore.linksStore.removeLink(t.id)}))},Object(c.c)(this),this._rootStore=t}return Object.defineProperty(t.prototype,"selectedItems",{get:function(){return this._selectedItems},enumerable:!1,configurable:!0}),t}(),Dt=function(){function t(){var t=this;this.importState=function(e,n){t._nodesStore.import(e),t._linksStore.import(n)},this.export=function(){return{nodes:t._nodesStore.export(),links:t._linksStore.export()}},this.importSettings=function(e){t._diagramSettings.import(e.diagram),t._nodesSettings.import(e.nodes),t._linksSettings.import(e.links),t._portsSettings.import(e.ports),t._callbacks.import(e.callbacks)},this._diagramSettings=new tt,this._nodesSettings=new Et,this._linksSettings=new ft,this._portsSettings=new Lt,this._callbacks=new A(this),this._diagramState=new ot(this),this._nodesStore=new It(this),this._linksStore=new gt(this),this._selectionState=new Tt(this)}return Object.defineProperty(t.prototype,"diagramState",{get:function(){return this._diagramState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodesStore",{get:function(){return this._nodesStore},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linksStore",{get:function(){return this._linksStore},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"diagramSettings",{get:function(){return this._diagramSettings},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodesSettings",{get:function(){return this._nodesSettings},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linksSettings",{get:function(){return this._linksSettings},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"portsSettings",{get:function(){return this._portsSettings},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"callbacks",{get:function(){return this._callbacks},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionState",{get:function(){return this._selectionState},enumerable:!1,configurable:!0}),t}(),Nt=function(){function t(t){var e=this;this._defaultType=Mt,this.import=function(t){e.setDefaultType(null==t?void 0:t.defaultType),e._components=s(s({},e._defaultComponents),e._createComponentCollection(null==t?void 0:t.components))},this.getComponent=function(t){var n,r=null!=t?t:e.defaultType;return null!==(n=e._components[r])&&void 0!==n?n:e._components[e.defaultType]},this.setDefaultType=function(t){e._defaultType=null!=t?t:Mt},this._createComponentCollection=function(t){var e={};return t&&Object.entries(t).forEach((function(t){var n=t[0],r=t[1];e[n]=new X(r)})),e},this._defaultComponents=this._createComponentCollection(t),this._components=s({},this._defaultComponents),Object(c.c)(this)}return Object.defineProperty(t.prototype,"defaultType",{get:function(){return this._defaultType},enumerable:!1,configurable:!0}),t}(),Mt="default",Rt=function(){function t(t,e,n){var r=this;this.import=function(t){r._source=r._createEndpointState(t.source),r._target=r._createEndpointState(t.target),r.setComponentType(t.componentType),r.setSegments(t.segments),r.setExtra(t.extra)},this.export=function(){return s({source:r.source.export(),target:r.target.export()},N({id:r._id,componentType:r.componentType,segments:r.segments,extra:r.extra}))},this.setComponentType=function(t){r._componentType=null!=t?t:Mt},this.setSegments=function(t){r._segments=null!=t?t:[]},this.setExtra=function(t){r._extra=null!=t?t:null},this._createEndpointState=function(t){return new H(t.nodeId,t.portId,r._rootStore)},this._rootStore=t,this._id=e,this._selected=!1,this._hovered=!1,this.import(n),Object(c.c)(this,{_rootStore:!1})}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"componentType",{get:function(){return this._componentType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"segments",{get:function(){return this._segments},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return Bt(this._rootStore,this.source,this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"componentDefinition",{get:function(){return this._rootStore.linksSettings.visualComponents.getComponent(this.componentType)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hovered",{get:function(){return this._hovered},set:function(t){this._hovered=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extra",{get:function(){return this._extra},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},enumerable:!1,configurable:!0}),t}();function Bt(t,e,n){var r=t.linksSettings;if(e.point&&n.point)return{svgPath:r.pathConstructor(e.point,n.point,e.port.type,n instanceof it?void 0:n.port.type),source:e.point,target:n.point}}var Ft=function(t){var e,n,r=Qt(),i=g(!1),a=g(!1),c=g(null),s=Object(o.useMemo)((function(){return t instanceof Rt?{onPointerEnter:function(){t.hovered=!0},onPointerLeave:function(){t.hovered=!1},onDragStart:function(){i.current=!0,a.current=!1,c.current=setTimeout((function(){a.current||(a.current=!0,r.selectionState.select(t,!0))}),Vt)},onDragEnd:function(e){var n=e.tap,o=e.ctrlKey;i.current=!1,c.current&&clearTimeout(c.current),n&&!a.current&&(a.current=!0,r.selectionState.select(t,o))}}:{}}),[t]),l=Object(u.a)(s,{eventOptions:{passive:!1}});return B(i.current,null===(n=null===(e=r.diagramState.diagramInnerRef.current)||void 0===e?void 0:e.ownerDocument)||void 0===n?void 0:n.body),{bind:l}},Vt=500,Ht=function(t,e){var n,r,i=Qt(),a=g(!1),c=g(!1),s=g(null),l=Object(o.useRef)(null),d=Object(o.useMemo)((function(){return{onDrag:function(e){var n=e.pinching,r=e.delta,o=e.ctrlKey,u=e.movement;!a.current||n||S(u)||(t.selected||c.current?t.selected&&(c.current=!0,i.selectionState.selectedItems.filter((function(t){return t instanceof zt})).forEach((function(t){return t.setPosition(E(t.position,I(r,1/i.diagramState.zoom)))}))):(i.selectionState.select(t,o),c.current=!0))},onDragStart:function(e){(function(t){return _(t,"react_fast_diagram_PortWrapper")})(e.event)||(a.current=!0,c.current=!1,s.current=setTimeout((function(){a.current&&!c.current&&(c.current=!0,i.selectionState.select(t,!0))}),Wt))},onDragEnd:function(e){var n=e.tap,r=e.ctrlKey;s.current&&clearTimeout(s.current),a.current=!1,n&&!c.current&&i.selectionState.select(t,r)}}}),[a,t,i]);return Object(u.a)(d,{domTarget:l,eventOptions:{passive:!1},enabled:e}),B(a.current,null===(r=null===(n=l.current)||void 0===n?void 0:n.ownerDocument)||void 0===r?void 0:r.body),{active:a.current,userInteractionElemRef:l}},Wt=500;var At=Object(a.a)((function(t){var e=t.link,n=Ft(e).bind;return i.a.createElement("g",null,i.a.createElement(e.componentDefinition.component,{bind:n,entity:e,settings:e.componentDefinition.settings}))})),Gt=Object(a.a)((function(t){var e=t.linksStore;return i.a.createElement("svg",null,Array.from(e.links).map((function(t){t[0];var e=t[1];return i.a.createElement(At,{key:e.id,link:e})})),i.a.createElement(At,{key:"__creation__",link:e.linkCreation}))})),Zt=Object(a.a)((function(t){var e=t.node,n=Ht(e).userInteractionElemRef;return i.a.createElement("div",{id:e.id,className:"react_fast_diagram_NodeWrapper",style:{left:e.position[0],top:e.position[1],zIndex:e.selected?10:void 0},ref:e.ref},i.a.createElement(e.componentDefinition.component,{draggableRef:n,entity:e,settings:e.componentDefinition.settings}))})),Ut=Object(a.a)((function(t){var e=t.nodesStore,n=Qt();return Object(o.useEffect)((function(){n.diagramState.zoomToFit()}),[]),i.a.createElement("div",null,Array.from(e.nodes).map((function(t){t[0];var e=t[1];return i.a.createElement(Zt,{key:e.id,node:e})})))})),qt=Object(a.a)((function(){var t=Qt(),e=t.diagramSettings.miniControlComponentState;return e.component&&i.a.createElement(e.component,{rootStore:t,settings:e.settings})})),Yt=Object(a.a)((function(t){var e=Qt(),n=V().transform;return i.a.createElement("div",{ref:e.diagramState.diagramInnerRef,style:s({},t.diagramStyles),className:"react_fast_diagram_DiagramInner"},i.a.createElement(Xt,null),i.a.createElement("div",{className:"react_fast_diagram_DiagramInner_DraggablePart",style:{transform:n}},i.a.createElement(Gt,{linksStore:e.linksStore}),i.a.createElement(Ut,{nodesStore:e.nodesStore})),i.a.createElement(qt,null))}));Yt.displayName="InnerDiagram";!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}(".react_fast_diagram_DiagramInner {\n  width: 100%;\n  height: 100%;\n  min-height: 100%;\n  position: relative;\n  overflow: hidden;\n  touch-action: none;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n\n.react_fast_diagram_DiagramInner * {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n  color: black;\n}\n\n.react_fast_diagram_DiagramInner_DraggablePart {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  overflow: visible;\n  transform-origin: 0px 0px;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  bottom: 0px;\n  /* useGestures hook use targetTouches instead of simply touches, \n  so we should set this property to Movable, otherwise if user put \n  one finger above Movable and another above DiagramInner, the hook \n  will not trigger pinch gesture */\n  pointer-events: none; \n}\n\n.react_fast_diagram_DiagramInner_DraggablePart > * {\n  overflow: visible;\n}\n\n.react_fast_diagram_NodeWrapper {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: -webkit-fit-content;\n  width: -moz-fit-content;\n  width: fit-content; \n  height: -webkit-fit-content; \n  height: -moz-fit-content; \n  height: fit-content;\n  pointer-events: auto;\n}\n\n.react_fast_diagram_Node_Default {\n  min-width: 10px;\n  min-height: 10px;\n  border-radius: 3px;\n  background-color: white;\n  border: #c2c2c2 solid 1px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n  margin: auto;\n  padding: 15px;\n  font-size: small;\n}\n\n.react_fast_diagram_PortContainer_Default {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.react_fast_diagram_PortContainer_Default_Horizontal > * {\n  margin: 0 5px;\n}\n\n.react_fast_diagram_PortContainer_Default_Vertical > * {\n  margin: 5px 0;\n}\n\n.react_fast_diagram_PortContainer_Default_Horizontal {\n  flex-direction: row;\n  width: 100%;\n}\n\n.react_fast_diagram_PortContainer_Default_Vertical {\n  flex-direction: column;\n  height: 100%;\n}\n\n.react_fast_diagram_Node_Default > * {\n  text-align: center;\n  margin: auto;\n}\n\n.react_fast_diagram_disabled_user_select {\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n\n.react_fast_diagram_BackgroundWrapper {\n  height: 100%;\n  width: 100%;\n  pointer-events: none;\n}\n\n.react_fast_diagram_Background_Default {\n  height: 100%;\n  width: 100%;\n}\n\n.react_fast_diagram_Minicontrol_Default {\n  position: absolute;\n  height: -webkit-fit-content;\n  height: -moz-fit-content;\n  height: fit-content;\n  display: flex;\n  flex-direction: column;\n}\n\n.react_fast_diagram_Minicontrol_Default_Btn {\n  background-color: white;\n  border: 1px solid rgb(209, 209, 209);\n  letter-spacing: normal;\n  display: inline-flex;\n  text-align: center;\n  align-items: center;\n  cursor: pointer;\n  font-weight: bold;\n}\n\n.react_fast_diagram_Minicontrol_Default_Btn > * {\n  text-align: center;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n}\n\n@media (hover: hover) {\n  .react_fast_diagram_Minicontrol_Default_Btn:hover {\n    background-color: rgb(228, 228, 228);\n    border: 1px solid rgb(209, 209, 209)\n  }\n}\n\n/* Containers with gap between items */\n\n.react_fast_diagram_flex_gap {\n  --gap: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.react_fast_diagram_flex_gap_y {\n  flex-direction: column;\n  height: 100%;\n}\n\n.react_fast_diagram_flex_gap_y > * {\n  margin: var(--gap) 0 0 0;\n}\n\n.react_fast_diagram_flex_gap_y > :first-child {\n  margin: 0;\n}\n\n.react_fast_diagram_flex_gap_x {\n  flex-direction: row;\n  width: 100%;\n}\n\n.react_fast_diagram_flex_gap_x > * {\n  margin: 0 0 0 var(--gap);\n}\n\n.react_fast_diagram_flex_gap_x > :first-child {\n  margin: 0;\n}\n\n/* Containers with gap between items */");var Jt=i.a.createContext(null);function Kt(t){var e=Object(o.useMemo)((function(){var e,n,r,o,i=new Dt;return t.settings&&i.importSettings(t.settings),i.importState(null!==(n=null===(e=t.initState)||void 0===e?void 0:e.nodes)&&void 0!==n?n:[],null!==(o=null===(r=t.initState)||void 0===r?void 0:r.links)&&void 0!==o?o:[]),i}),[]);return Object(o.useEffect)((function(){t.storeRef&&(t.storeRef.current=e)}),[e,t.storeRef]),i.a.createElement(Jt.Provider,{value:e},i.a.createElement(Yt,null))}Kt.displayName="Diagram";var Qt=function(){return Object(o.useContext)(Jt)},Xt=Object(a.a)((function(){var t=Qt(),e=t.diagramSettings,n=t.diagramState;return i.a.createElement("div",{className:"react_fast_diagram_BackgroundWrapper"},i.a.createElement(e.backgroundComponentState.component,{diagramOffset:n.offset,diagramZoom:n.zoom,settings:e.backgroundComponentState.settings}))})),$t=function(t){var e=t.rootStore,n=t.settings;return n=null!=n?n:oe,i.a.createElement("div",{className:"react_fast_diagram_Minicontrol_Default",style:s(s({},te(n)),null==n?void 0:n.containerStyle)},e.selectionState.selectedItems.length>0&&i.a.createElement(ee,{size:n.buttonsSize,onClick:e.selectionState.removeSelected}),n.buttons.zoomIn&&i.a.createElement(ne,{size:n.buttonsSize,onClick:e.diagramState.zoomIn,children:"+"}),n.buttons.zoomOut&&i.a.createElement(ne,{size:n.buttonsSize,onClick:e.diagramState.zoomOut,children:"-"}),i.a.createElement(ne,{size:n.buttonsSize,onClick:e.diagramState.zoomToFit,children:"[ ]"}))};function te(t){return{top:"left-top"==t.position||"right-top"==t.position?t.parentOffset:void 0,right:"right-bottom"==t.position||"right-top"==t.position?t.parentOffset:void 0,bottom:"left-bottom"==t.position||"right-bottom"==t.position?t.parentOffset:void 0,left:"left-top"==t.position||"left-bottom"==t.position?t.parentOffset:void 0}}var ee=function(t){return i.a.createElement("div",{onClick:t.onClick,className:"react_fast_diagram_Minicontrol_Default_Btn",style:{width:t.size+"px",height:t.size+"px",padding:5,backgroundColor:"#fa4040"}},i.a.createElement("svg",{viewBox:"0 0 488.936 488.936",fill:"white"},i.a.createElement("g",null,i.a.createElement("path",{d:"M381.16,111.948H107.376c-6.468,0-12.667,2.819-17.171,7.457c-4.504,4.649-6.934,11.014-6.738,17.477l9.323,307.69\r\n\t\t\tc0.39,12.92,10.972,23.312,23.903,23.312h20.136v-21.012c0-24.121,19.368-44.049,43.488-44.049h127.896\r\n\t\t\tc24.131,0,43.893,19.928,43.893,44.049v21.012h19.73c12.933,0,23.52-10.346,23.913-23.268l9.314-307.7\r\n\t\t\tc0.195-6.462-2.234-12.863-6.738-17.513C393.821,114.767,387.634,111.948,381.16,111.948z"}),i.a.createElement("path",{d:"M309.166,435.355H181.271c-6.163,0-11.915,4.383-11.915,11.516v30.969c0,6.672,5.342,11.096,11.915,11.096h127.895\r\n\t\t\tc6.323,0,11.366-4.773,11.366-11.096v-30.969C320.532,440.561,315.489,435.355,309.166,435.355z"}),i.a.createElement("path",{d:"M427.696,27.106C427.696,12.138,415.563,0,400.591,0H88.344C73.372,0,61.239,12.138,61.239,27.106v30.946\r\n\t\t\tc0,14.973,12.133,27.106,27.105,27.106H400.59c14.973,0,27.105-12.133,27.105-27.106L427.696,27.106L427.696,27.106z"}))))},ne=function(t){return i.a.createElement("div",{onClick:t.onClick,className:"react_fast_diagram_Minicontrol_Default_Btn",style:{width:t.size+"px",height:t.size+"px"}},i.a.createElement("span",null,t.children))},re=function(t){var e=s(s({},oe),t||{});return{component:$t,settings:e}},oe={position:"left-bottom",containerStyle:{},buttonsSize:30,buttons:{zoomIn:!0,zoomOut:!0},parentOffset:20},ie=Object.assign({React:i.a},i.a,r,{observer:a.a});e.a=ie}}]);